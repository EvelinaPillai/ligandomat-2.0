
<html metal:use-macro="load: base_layout.pt">
<!DOCTYPE html>
<html lang="${request.locale_name}">
  <head>
    <!-- DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.4/css/jquery.dataTables.css">
    <link rel="stylesheet" type="text/css" href="${request.static_url('ligando:static/dataTables.tableTools.css')}">

  </head>

  <body>
    <div style="margin-left: 50pt;margin-top:20pt">
    <table id="example" auto class="display" cellspacing="0" width="80%"> <thead>
            <tr tal:condition="grouping == 'run'">
                <th>Sequence</th>
                <th>RT [min]</th>
                <th>Score</th>
                <th>E-value</th>
                <th>Q-value</th>
                <th>#PSM</th>
                <th>HLA Typing</th>
                <th>Protein</th>
                <th>Histology</th>
                <th>Source</th>
                <th>MS Run</th>
            </tr>
            <tr tal:condition="grouping == 'peptide'">
                <th>Sequence</th>
                <th>Protein</th>
                <th>Source</th>
                <th>HLA Typing</th>
            </tr>
            <tr tal:condition="grouping == 'source'">
                <th>Sequence</th>
                <th>RT [min]</th>
                <th>Score</th>
                <th>E-value</th>
                <th>Q-value</th>
                <th>HLA Typing</th>
                <th>Protein</th>
                <th>Histology</th>
                <th>Source</th>
            </tr>
            <tr tal:condition="grouping == 'source_psm'">
                <th>Sequence</th>
                <th>Score</th>
                <th>E-value</th>
                <th>Q-value</th>
                <th>#PSM</th>
                <th>HLA Typing</th>
                <th>Protein</th>
                <th>Histology</th>
                <th>Source</th>
            </tr>
        </thead></table>
    </div>


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

    <!-- jQuery -->
    <!-- <script type="text/javascript" charset="utf8" src="//code.jquery.com/jquery-1.10.2.min.js"></script> -->

    <!-- DataTables -->
    <script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.4/js/jquery.dataTables.js"></script>

    <!-- TableTools -->
    <script type="text/javascript" charset="utf8" src="${request.static_url('ligando:static/js/dataTables.tableTools.js')}"></script>


    <script>

    //TODO: choose delimiter
    $(document).ready(function() {
    if ("${grouping}" == "run") {
        $('#example').dataTable( {
            data: ${project},
            columns: [
                { data: "sequence" },
                { data: "minRT",
                "render": function ( data, type, row ) {
                    return data +' - '+ row.maxRT+'';
                }},
                { data: "minScore",
                "render": function ( data, type, row ) {
                    return data +' - '+ row.maxScore+'';
                }},
                { data: "minE",
                "render": function ( data, type, row ) {
                    return data +' - '+ row.maxE+'';
                }},
                { data: "minQ",
                "render": function ( data, type, row ) {
                    return data +' - '+ row.maxQ+'';
                }},
                { data: "PSM"},
                { data: "hla_category"},
                { data: "protein"},
                { data: "histology"},
                { data: "name"},
                { data: "filename"}
            ],
            "sDom": 'T<"clear">lfrtip',
            oTableTools: {
                "sSwfPath": "${request.static_url('ligando:static/swf/copy_csv_xls_pdf.swf')}",
                "aButtons":  ["csv"]
            }

        } );
    }else if ("${grouping}" == "peptide"){
        $('#example').dataTable( {
            data: ${project},
            columns: [
                { data: "sequence" },
                { data: "protein"},
                { data: "name"},
                { data: "hla_category"}
            ],
            "sDom": 'T<"clear">lfrtip',
            oTableTools: {
                "sSwfPath": "${request.static_url('ligando:static/swf/copy_csv_xls_pdf.swf')}",
                "aButtons":  ["csv"]
            }
        } );
        }
     else if ("${grouping}" == "source"){
        $('#example').dataTable( {
            data: ${project},
            columns: [
                { data: "sequence" },
                    { data: "minRT",
                "render": function ( data, type, row ) {
                    return data +' - '+ row.maxRT+'';
                }},
                { data: "minScore",
                "render": function ( data, type, row ) {
                    return data +' - '+ row.maxScore+'';
                }},
                { data: "minE",
                "render": function ( data, type, row ) {
                    return data +' - '+ row.maxE+'';
                }},
                { data: "minQ",
                "render": function ( data, type, row ) {
                    return data +' - '+ row.maxQ+'';
                }},
                { data: "hla_category"},
                { data: "protein"},
                { data: "histology"},
                { data: "source_name"}
            ],
            "sDom": 'T<"clear">lfrtip',
            oTableTools: {
                "sSwfPath": "${request.static_url('ligando:static/swf/copy_csv_xls_pdf.swf')}",
                "aButtons":  ["csv"]


            }
        } );
    }
        else if ("${grouping}" == "source_psm"){
        $('#example').dataTable( {
            data: ${project},
            columns: [
                { data: "sequence" },
                { data: "minScore",
                "render": function ( data, type, row ) {
                    return data +' - '+ row.maxScore+'';
                }},
                { data: "minE",
                "render": function ( data, type, row ) {
                    return data +' - '+ row.maxE+'';
                }},
                { data: "minQ",
                "render": function ( data, type, row ) {
                    return data +' - '+ row.maxQ+'';
                }},
                { data: "PSM"},
                { data: "hla_category"},
                { data: "protein"},
                { data: "histology"},
                { data: "source_name"}
            ],
            "sDom": 'T<"clear">lfrtip',
            oTableTools: {
                "sSwfPath": "${request.static_url('ligando:static/swf/copy_csv_xls_pdf.swf')}",
                "aButtons":  ["csv"]


            }
        } );
    }
    } );



    </script>


  </body>
</html>
