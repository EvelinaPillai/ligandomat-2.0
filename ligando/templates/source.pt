
<html metal:use-macro="load: base_layout.pt">
<!DOCTYPE html>
<html lang="${request.locale_name}">
<head>


</head>

<body>
<div class="main_wrapper">
<div class="wrapper">
    <h1 style="text-align: center">${source}</h1>
    <div style="align-content: center;margin-left: auto; margin-right: auto;">
        <h3>Basic Statistics</h3>
            <table class="info_table" width="25%">
            <tr>
                <td>Peptides: </td><td id="pep_stat"> </td>
            </tr>
            <tr class="alt">
                <td >Spectra: </td><td id="spec_stat"> </td>
            </tr>
            <tr>
                <td>Proteins: </td><td id="prot_stat"> </td>
            </tr>
            </table>
        <br>
        <h3>Source Information</h3>
            <table class="info_table" width="50%">
            <tr>
                <td width="50%">Histology:</td><td id="histology"></td>
            </tr>
            <tr class="alt">
                <td>Dignity:</td><td id="dignity"></td>
            </tr>
            <tr>
                <td>Organ:</td><td id="organ"></td>
            </tr>
            <tr class="alt">
                <td>Organism:</td><td id="organism"></td>
            </tr>
            <tr>
                <td>Celltype:</td><td id="celltype"></td>
            </tr>
            <tr class="alt">
                <td>Location:</td><td id="location"></td>
            </tr>
            <tr >
                <td>Metastatis:</td><td id="metastatis"></td>
            </tr>
            <tr class="alt">
                <td>HLA-Typing: </td><td id="typing"> </td>
            </tr>
            <tr >
                <td>Responsible Person:</td><td id="person"></td>
            </tr>
            <tr class="alt">
                <td>Comment: </td><td id="comment"> </td>
            </tr>
                </table>

    </div>
    </div>
<br>

    <table id="example"  class="display" cellspacing="0" width="100%">
        <thead>
        <tr>
        <th>MS Run</th>
        </tr>
        </thead>
    </table>
</div>

<script>
$(document).ready(function() {
    // Setting the statistics
    document.getElementById("pep_stat").innerHTML = "<a title='Show all Peptides'  class='nostylelink' href='javascript:post(\x22../peptide_query\x22, {source: \x22${source}\x22, grouping:\x22source\x22}," +${statistic}[0]["count_pep"]+ " )'> "+${statistic}[0]["count_pep"]+"</a>";
    // TODO: create spectrum hit query
    document.getElementById("spec_stat").innerHTML = ${statistic}[0]["count_hits"];
    document.getElementById("prot_stat").innerHTML = ${statistic}[0]["count_prot"];
    // extract alles and link them
    var alleles = ${statistic}[0]["hla_category"].split(",");
    var allele_string = "";
    for(var i=0; i<alleles.length; i++){
        var a = alleles[i].trim();
        allele_string = allele_string + "<a class='nostylelink'  href= '/hla/"+a + "'>"+a + "</a>, ";
    }
    document.getElementById("typing").innerHTML = allele_string.slice(0, -2);
    document.getElementById("histology").innerHTML = ${statistic}[0]["histology"];
    document.getElementById("organ").innerHTML = ${statistic}[0]["organ"];
    document.getElementById("comment").innerHTML = ${statistic}[0]["comment"];
    document.getElementById("organism").innerHTML = ${statistic}[0]["organism"];
    document.getElementById("dignity").innerHTML = ${statistic}[0]["dignity"];
    document.getElementById("celltype").innerHTML = ${statistic}[0]["celltype"];
    document.getElementById("location").innerHTML = ${statistic}[0]["location"];
    // Write Yes or No instead 0 and 1
    if(${statistic}[0]["metastatis"]==0){
        document.getElementById("metastatis").innerHTML = "No"
    }else{
        document.getElementById("metastatis").innerHTML = "Yes"
    }
    document.getElementById("person").innerHTML = "<a class='nostylelink'  href= '/person/"+${statistic}[0]["person"] + "'>"+${statistic}[0]["person"] + "</a>, ";




});


$(document).ready(function() {

$('#example').dataTable( {
    "paging":   false,
    "ordering": false,
    "info":     false,
    searching: false,
    data: ${runs},
    columns: [
        { data: "filename",
            "render": function ( data, type, row ) {
                return "<a class='nostylelink'  href= '/msrun/"+row["ms_run_id"] + "'>"+data + "</a>" ;
            }
        }
    ]
} );
} );

</script>



</body>

</html>
